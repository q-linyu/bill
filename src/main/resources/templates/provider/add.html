<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>账单管理系统</title>
    <meta charset="utf-8">
    <meta name="keywords" content="账单管理系统" />
    <meta name="description" content="账单管理系统">
    <meta name="author" content="q-linyu">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" th:href="@{/assets/googleapis/fonts.googleapis.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/jquery-growl/jquery.growl.css}" >
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/font-awesome/4.7.0/css/font-awesome.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/uniform/css/default.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/switchery/switchery.min.css}">
    <!-- 加载进度条 -->
    <link rel="stylesheet" th:href="@{/assets/nprogress/nprogress.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/space.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/home.css}">
    <style type="text/css">
        .form-horizontal .checkbox, .form-horizontal .checkbox-inline, .form-horizontal .radio, .form-horizontal .radio-inline{
            margin-top: -5px;
        }

        .error{
            color: #ff0e1b;
        }
    </style>
</head>
<body>
<!-- Page Container -->
<div class="page-container">

    <!-- 左侧导航栏 -->
    <div th:replace="common/sidebar :: sidebar(activeUrl = 'provider')"></div>

    <!-- Page Content -->
    <div class="page-content">

        <!-- 头部 -->
        <div th:replace="common/header :: header"></div>

        <!-- Page Inner -->
        <div class="page-inner">
            <div class="page-title">
                <h3 class="breadcrumb-header">添加客户</h3>
            </div>
            <div id="main-wrapper">
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-white">
                            <div class="panel-body">
                                <form class="form-horizontal" id="addForm" method="post">
                                    <div class="form-group">
                                        <label for="providerCode" class="col-sm-3 control-label">供应商编码</label>
                                        <div class="col-sm-5">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    name="providerCode"
                                                    id="providerCode"
                                                    placeholder="请输入供应商编码"
                                                    onfocus="inputfocus(this)"
                                                    onblur="inputBlur(this)"
                                            >
                                            <p class="help-block error"></p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="providerName" class="col-sm-3 control-label">供应商名称</label>
                                        <div class="col-sm-5">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    name="providerName"
                                                    id="providerName"
                                                    placeholder="请输入供应商名称"
                                                    onfocus="inputfocus(this)"
                                                    onblur="inputBlur(this)"
                                            >
                                            <p class="help-block error"></p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="people" class="col-sm-3 control-label">供应商</label>
                                        <div class="col-sm-5">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    name="people"
                                                    id="people"
                                                    placeholder="请输入供应商"
                                                    onfocus="inputfocus(this)"
                                                    onblur="inputBlur(this)"
                                            >
                                            <p class="help-block error"></p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="phone" class="col-sm-3 control-label">电话号码</label>
                                        <div class="col-sm-5">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    name="phone"
                                                    id="phone"
                                                    placeholder="请输入电话号码"
                                                    onfocus="inputfocus(this)"
                                                    onblur="inputBlur(this)"
                                            >
                                            <p class="help-block error"></p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="address" class="col-sm-3 control-label">地址</label>
                                        <div class="col-sm-5">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    name="address"
                                                    id="address"
                                                    onfocus="inputfocus(this)"
                                                    onblur="inputBlur(this)"
                                                    placeholder="请输入地址"
                                            >
                                            <p class="help-block error"></p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="fax" class="col-sm-3 control-label">传真</label>
                                        <div class="col-sm-5">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    name="fax"
                                                    id="fax"
                                                    placeholder="请输入传真"
                                                    onfocus="inputfocus(this)"
                                                    onblur="inputBlur(this)"
                                            >
                                            <p class="help-block error"></p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">描述</label>
                                        <div class="col-sm-5">
                                            <textarea
                                                    name="describe"
                                                    id="describe"
                                                    class="form-control"
                                                    rows="10"
                                                    onfocus="inputfocus(this)"
                                                    onblur="inputBlur(this)"
                                                    style="resize:none;"></textarea>
                                            <p class="help-block error"></p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-3 col-sm-5">
                                            <button
                                                    type="submit"
                                                    class="btn btn-primary btn-sm btn-block"
                                                    style="margin-top:30px;margin-bottom:-14px;"
                                                    onclick="addHandler();return false;"
                                            >保 存
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 底部 -->
            <div th:replace="common/footer :: footer"></div>

        </div>
    </div>


</div>
<script type="text/javascript" th:src="@{/webjars/jquery/3.3.1/jquery.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/jquery-growl/jquery.growl.js}"></script>
<script type="text/javascript" th:src="@{/webjars/bootstrap/3.3.7/js/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/jquery-slimscroll/jquery.slimscroll.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/uniform/js/jquery.uniform.standalone.js}"></script>
<!-- 加载进度条 -->
<script type="text/javascript" th:src="@{/assets/nprogress/nprogress.js}"></script>
<script type="text/javascript" th:src="@{/assets/nprogress/initNprogress.js}"></script>
<script type="text/javascript" th:src="@{/js/space.min.js}"></script>
<script type="text/javascript">

    // 表单验证
    function checkValid(dom) {

        // 默认为false
        var bool = true;

        var id = $(dom).attr("id");
        var val = $(dom).val();

        switch (id) {
            case "providerCode":
                if ("" === val){
                    $("#providerCode").next("p").html("供应商编码不能为空").parent().parent().addClass("has-error");
                    bool = false;
                }else {
                    $("#providerCode").next("p").html("").parent().parent().addClass("has-success").removeClass("has-error");
                }
                break;
            case "providerName":
                if ("" === val){
                    $("#providerName").next("p").html("供应商名称不能为空").parent().parent().addClass("has-error");
                    bool = false;
                }else {
                    $("#providerName").next("p").html("").parent().parent().addClass("has-success").removeClass("has-error");
                }
                break;
            case "people":
                if ("" === val){
                    $("#people").next("p").html("供应商不能为空").parent().parent().addClass("has-error");
                    bool = false;
                }else {
                    $("#people").next("p").html("").parent().parent().addClass("has-success").removeClass("has-error");
                }
                break;
            case "phone":
                if ("" === val){
                    $("#phone").next("p").html("电话号码不能为空").parent().parent().addClass("has-error");
                    bool = false;
                }else {
                    $("#phone").next("p").html("").parent().parent().addClass("has-success").removeClass("has-error");
                }
                break;
            case "address":
                if ("" === val){
                    $("#address").next("p").html("地址不能为空").parent().parent().addClass("has-error");
                    bool = false;
                }else {
                    $("#address").next("p").html("").parent().parent().addClass("has-success");
                }
                break;
            case "fax":
                if ("" === val){
                    $("#fax").next("p").html("传真不能为空").parent().parent().addClass("has-error").removeClass("has-success");
                    bool = false;
                }else {
                    $("#fax").next("p").html("").parent().parent().addClass("has-success").removeClass("has-error");
                }
                break;
            default:
                bool = false;
                break;
        }

        return bool;
    }

    // 获取焦点
    function inputfocus(dom) {
        $(dom).next("p").html("").removeClass("error").parent().parent().removeClass("has-error has-success");
    }

    // 失去焦点
    function inputBlur(dom) {
        checkValid(dom);
    }


    // 新增
    function addHandler() {
        var bool = true;

        // 表达验证
        $("#addForm input[id]:not([type='radio'])").each(function (i,e) {
            if (checkValid(e) === false){
                bool = false;
            }
        });

        if (bool){
            console.log("进入 ajax 操作.......");
            // 发送ajax
            $.ajax({
                url: '/provider/add',
                type: 'POST',
                data: $("#addForm").serialize(),
                dataType: 'JSON',
                success : function(res){
                    if (res.status === 201){
                        $.growl.notice({
                            title: "温馨提示",
                            message: res.msg
                        });
                        // 数据清空
                        $("#providerCode").val('');
                        $("#providerName").val('');
                        $("#people").val('');
                        $("#phone").val('');
                        $("#address").val('');
                        $("#fax").val('');
                        $("#describe").val('');
                        // 样式清空
                        $(".form-group").removeClass("has-success").find('p').removeClass('error').html('');
                    }else {
                        $.growl.error({
                            title: "温馨提示",
                            message: res.msg
                        });
                    }
                },
                error : function(err){
                    console.error(err);
                }
            });
        }
        return bool;

    }





</script>
</body>
</html>